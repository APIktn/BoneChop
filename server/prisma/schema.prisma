generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model User {
  Id                Int      @id @default(autoincrement())
  UserCode          String   @unique @db.VarChar(20)
  UserName          String?  @db.VarChar(150)
  UserEmail         String   @db.VarChar(150)
  Password          String   @db.VarChar(150)
  FirstName         String   @db.VarChar(150)
  LastName          String   @db.VarChar(150)
  Address           String?   @db.Text
  Tel               String?   @db.VarChar(20)
  Profile_Image     String   @db.Text
  Upload_Image      String?  @db.Text
  Upload_Image_Id   String?  @db.Text
  CreateBy          String   @db.VarChar(20)
  CreateDateTime    DateTime @db.DateTime
  UpdateBy          String   @db.VarChar(20)
  UpdateDateTime    DateTime @db.DateTime
  TokenVersion      Int      @default(0)
   
  tokens    Token[]

  @@map("tbl_mas_users")
}

model ProductHeader {
  Id             Int       @id @default(autoincrement())
  ProductCode    String    @unique @db.VarChar(150)
  ProductName    String    @db.VarChar(255)
  ProductDes     String    @db.Text
  CreateBy       String    @db.VarChar(20)
  CreateDateTime DateTime  @db.DateTime
  UpdateBy       String    @db.VarChar(20)
  UpdateDateTime DateTime  @db.DateTime

  images ProductImage[]
  lines  ProductLine[]

  @@map("tbl_trs_product_header")
}

model ProductImage {
  Id              Int      @id @default(autoincrement())
  IdRef           Int
  ImageType       String   @db.VarChar(50)
  ProductImage    String   @db.Text
  ProductImageId  String?   @db.Text
  CreateBy        String   @db.VarChar(20)
  CreateDateTime  DateTime @db.Date
  UpdateBy        String   @db.VarChar(20)
  UpdateDateTime  DateTime @db.Date

  header ProductHeader @relation(fields: [IdRef], references: [Id], onDelete: Cascade, onUpdate: Cascade)

  @@map("tbl_trs_product_image")
}

model ProductLine {
  Id             Int      @id @default(autoincrement())
  IdRef          Int
  LineNo         Int
  Size           String   @db.VarChar(150)
  Price          Decimal  @db.Decimal(10, 2)
  Amount         Int
  Note           String?   @db.Text
  CreateBy       String   @db.VarChar(20)
  CreateDateTime DateTime @db.DateTime
  UpdateBy       String   @db.VarChar(20)
  UpdateDateTime DateTime @db.DateTime

  header ProductHeader @relation(fields: [IdRef], references: [Id], onDelete: Cascade, onUpdate: Cascade)

  @@map("tbl_trs_product_line")
}

model Token {
  Id            Int      @id @default(autoincrement())
  UserId        Int
  TokenHash     String   @db.VarChar(255)
  ExpiresAt     DateTime @db.DateTime
  AbsoluteExp   DateTime @db.DateTime
  CreateBy      String   @db.VarChar(20)
  CreatedAt     DateTime @default(now())

  user User @relation(fields: [UserId], references: [Id], onDelete: Cascade)

  @@index([UserId])
}

